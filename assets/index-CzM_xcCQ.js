import"./index-Bni88ulI.js";/* empty css                   *//* empty css                  *//* empty css                   *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                        *//* empty css                 *//* empty css                   *//* empty css                  *//* empty css                *//* empty css                     */import{r,W as X,f as Y,x as Z,B as g,O as a,G as z,P as ee,F as t,ah as ae,K as d,E as le,L as te,y as N}from"./vue-NMw_sZBQ.js";import{l as oe,d as D,u as ne,a as se}from"./bbb-B0i5f64G.js";import{_ as re}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                       */import{E as m,W as ie,C as ue,V as de,q as me,a0 as pe,a1 as ce,a2 as ge,a3 as fe,a4 as ve,a5 as be,B as _e,a6 as U}from"./element-DEJX7W-M.js";import"./vxe-BsGI8rv1.js";const ye={class:"container"},he={class:"header"},xe={class:"table-container"},Ve={class:"pagination-container"},Ce={class:"dialog-footer"},Ee={__name:"index",setup(Se){const y=r(!1),C=r([]),h=r(0),p=r(!1),f=r(!1),x=r(!1),b=r(),T=r(!0),V=r([]),E=r(!0),S=r(!0),n=r({name:"",pageNum:1,pageSize:10}),q=()=>{n.value={name:"",pageNum:1,pageSize:10},i()},s=X({id:"",name:"",sex:"",age:"",score:""}),P={name:[{required:!0,message:"请输入姓名",trigger:"blur"},{min:2,max:10,message:"姓名长度在2到10个字符",trigger:"blur"}],age:[{required:!0,message:"请输入年龄",trigger:"blur"},{type:"number",message:"请输入正确的年龄",trigger:"blur",transform:l=>Number(l)},{type:"number",min:1,max:150,message:"年龄应在1-150之间",trigger:"blur"}],score:[{required:!0,message:"请输入成绩",trigger:"blur"},{type:"number",message:"请输入正确的成绩",trigger:"blur",transform:l=>Number(l)},{type:"number",min:0,max:100,message:"年龄应在0-100之间",trigger:"blur"}],sex:[{required:!0,message:"请选择角色",trigger:"change"}]};Y(()=>{i()});const i=async l=>{y.value=!0;try{oe(n.value).then(e=>{C.value=e.data.rows,h.value=e.data.total,e.data})}catch(e){m.error("获取数据失败: "+e.message)}finally{y.value=!1}},R=l=>{V.value=l.map(e=>e.id),E.value=l.length!=1,S.value=!l.length},$=()=>{f.value=!1,I(),p.value=!0},F=l=>{f.value=!0,Object.assign(s,l),p.value=!0},M=()=>{U.confirm(`是否确定要删除编号为 "${V.value}" 的行？`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{D(V.value).then(l=>{m.success("删除成功"),i()})}catch(l){m.error("删除失败: "+l.message)}}).catch(()=>{})},O=l=>{U.confirm(`是否确定要删除编号为 "${l.id}" 的行？`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{D(l.id).then(e=>{m.success("删除成功"),i()})}catch(e){m.error("删除失败: "+e.message)}}).catch(()=>{})},k=()=>{i()},j=()=>{b.value.validate(async l=>{if(l){x.value=!0;try{f.value?ne(s).then(e=>{p.value=!1,m.success("更新成功"),i()}):se(s).then(e=>{p.value=!1,m.success("添加成功"),n.pageNum=Math.ceil(h.value/n.pageSize),i()})}catch(e){m.error("操作失败: "+e.message)}finally{x.value=!1}}})},I=()=>{Object.assign(s,{id:"",name:"",sex:"",age:"",score:""}),b.value&&b.value.clearValidate()},K=l=>{n.pageSize=l,i()},L=l=>{n.pageNum=l,i()};return(l,e)=>{const _=ue,v=ie,w=de,u=me,c=ce,W=ge,A=fe,B=be,G=ve,Q=_e,H=pe;return N(),Z("div",ye,[g("div",he,[g("div",null,[z(a(w,{model:n.value,ref:"queryRef",inline:!0,"label-width":"68px"},{default:t(()=>[a(v,{label:"姓名",prop:"name"},{default:t(()=>[a(_,{modelValue:n.value.name,"onUpdate:modelValue":e[0]||(e[0]=o=>n.value.name=o),placeholder:"请输入姓名",clearable:"",onKeyup:ae(k,["enter"])},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),[[ee,T.value]]),a(u,{type:"primary",icon:"Search",onClick:k},{default:t(()=>[...e[9]||(e[9]=[d("搜索",-1)])]),_:1}),a(u,{icon:"Refresh",onClick:q},{default:t(()=>[...e[10]||(e[10]=[d("重置",-1)])]),_:1})]),g("div",null,[a(u,{type:"primary",plain:"",icon:"Plus",onClick:$},{default:t(()=>[...e[11]||(e[11]=[d("新增",-1)])]),_:1}),a(u,{type:"success",plain:"",icon:"Edit",disabled:E.value,onClick:l.handleUpdate},{default:t(()=>[...e[12]||(e[12]=[d("修改",-1)])]),_:1},8,["disabled","onClick"]),a(u,{type:"danger",plain:"",icon:"Delete",disabled:S.value,onClick:M},{default:t(()=>[...e[13]||(e[13]=[d("删除",-1)])]),_:1},8,["disabled"])])]),g("div",xe,[z((N(),le(W,{data:C.value,style:{width:"100%"},onSelectionChange:R,stripe:"",border:""},{default:t(()=>[a(c,{type:"selection",width:"55",align:"center"}),a(c,{prop:"id",label:"编号",width:"80"}),a(c,{prop:"name",label:"姓名"}),a(c,{prop:"sex",label:"性别"}),a(c,{prop:"age",label:"年龄"}),a(c,{prop:"score",label:"成绩"}),a(c,{label:"操作",width:"180"},{default:t(o=>[a(u,{size:"small",onClick:J=>F(o.row)},{default:t(()=>[...e[14]||(e[14]=[d("修改",-1)])]),_:1},8,["onClick"]),a(u,{size:"small",type:"danger",onClick:J=>O(o.row)},{default:t(()=>[...e[15]||(e[15]=[d("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[H,y.value]])]),g("div",Ve,[a(A,{"current-page":n.value.pageNum,"onUpdate:currentPage":e[1]||(e[1]=o=>n.value.pageNum=o),"page-size":n.value.pageSize,"onUpdate:pageSize":e[2]||(e[2]=o=>n.value.pageSize=o),"page-sizes":[10,20,50,100],total:h.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:K,onCurrentChange:L},null,8,["current-page","page-size","total"])]),a(Q,{modelValue:p.value,"onUpdate:modelValue":e[8]||(e[8]=o=>p.value=o),title:f.value?"修改用户":"添加用户",width:"500px",center:"","destroy-on-close":""},{footer:t(()=>[g("span",Ce,[a(u,{onClick:e[7]||(e[7]=o=>p.value=!1)},{default:t(()=>[...e[16]||(e[16]=[d("取消",-1)])]),_:1}),a(u,{type:"primary",onClick:j,loading:x.value},{default:t(()=>[d(te(f.value?"更新":"添加"),1)]),_:1},8,["loading"])])]),default:t(()=>[a(w,{ref_key:"formRef",ref:b,model:s,rules:P,"label-width":"80px"},{default:t(()=>[a(v,{label:"姓名",prop:"name"},{default:t(()=>[a(_,{modelValue:s.name,"onUpdate:modelValue":e[3]||(e[3]=o=>s.name=o),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1}),a(v,{label:"性别",prop:"sex"},{default:t(()=>[a(G,{modelValue:s.sex,"onUpdate:modelValue":e[4]||(e[4]=o=>s.sex=o),placeholder:"请选择性别"},{default:t(()=>[a(B,{label:"男",value:"男"}),a(B,{label:"女",value:"女"})]),_:1},8,["modelValue"])]),_:1}),a(v,{label:"年龄",prop:"age"},{default:t(()=>[a(_,{modelValue:s.age,"onUpdate:modelValue":e[5]||(e[5]=o=>s.age=o),placeholder:"请输入年龄"},null,8,["modelValue"])]),_:1}),a(v,{label:"成绩",prop:"score"},{default:t(()=>[a(_,{modelValue:s.score,"onUpdate:modelValue":e[6]||(e[6]=o=>s.score=o),placeholder:"请输入成绩"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},We=re(Ee,[["__scopeId","data-v-7ef7f9af"]]);export{We as default};
